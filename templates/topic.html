{% extends "base.html" %}

{% block content %}

    <div class="search_top">
        <div class="s-bar">
            <div>
                <input type="text" name="query_word" id="query_word" value="输入人员姓名或概念" onfocus="this.value = '';" onblur="if (this.value == '') {this.value = '输入人员姓名或概念';}">
                <input type="submit" id="query" value="搜索" onclick="query()"/>
            </div>
        </div>
    </div>

    <canvas id="viewport"></canvas>
    <script>
        $(document).ready(function () {

            var theUI = {
              nodes:{
                    "{{query}}":{color:"#FF3900", shape:"dot", alpha:1},

                    "相关双语":{color:"#FF8B00", shape:"dot", alpha:1},

                    {% for info in topics.bilingual_cn %}
                        '{{ info }};':{color:"#086CA2", alpha:1, link:"{% url 'topic' query=info %}"},
                    {% endfor %}

                    {% for info in topics.bilingual_en %}
                        '{{ info }};':{color:"#00B454", alpha:1, link:"{% url 'topic' query=info %}"},
                    {% endfor %}

                    "上位概念":{color:"#FF8B00", shape:"dot", alpha:1},
                    {% for upper in topics.topics_upper %}
                        '{{ upper }}':{color:"#086CA2", alpha:1, link:"{% url 'topic' query=upper %}"},
                    {% endfor %}
                    "下位概念":{color:"#FF8B00", shape:"dot", alpha:1},
                    {% for lower in topics.topics_lower %}
                        '{{ lower }}':{color:"#086CA2", alpha:1, link:"{% url 'topic' query=lower %}"},
                    {% endfor %}

                    },
              edges:{
                    "{{query}}":{
                        "上位概念":{length:.8},
                        "下位概念":{length:.8},
                        "相关双语":{length:.8},
                    },

                    "相关双语":{
                    {% for info in topics.bilingual_cn %}
                        "{{ info }};":{length:.5},
                    {% endfor %}
                    },

                    {% for cn in topics.bilingual_cn %}
                        "{{ cn }};":{
                            {% for en in topics.bilingual_en %}
                                {% ifequal forloop.counter forloop.parentloop.counter %}
                                    '{{ en}};':{},
                                {% endifequal %}
                            {% endfor %}
                        },
                    {% endfor %}

                    '上位概念':{
                    {% for upper in topics.topics_upper %}
                        '{{ upper }}':{},
                    {% endfor %}
                    },

                    '下位概念':{
                    {% for lower in topics.topics_lower %}
                        '{{ lower }}':{},
                    {% endfor %}
                    },
              }
            };
            initGraph(theUI);
        });
    </script>
{% endblock %}